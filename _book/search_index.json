[["index.html", "SOP manual for fMRI analysis: Part 1 Chapter 1 Prerequisites", " SOP manual for fMRI analysis: Part 1 Christian Coffman 2020-10-22 Chapter 1 Prerequisites This is a sample book written in Markdown. This is a series of SOP files of using the facilities to start your research in the Division of Biostatistics in SPHatUMN, esp. focusing on fMRI image analysis. You can use anything that Pandoc’s Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: # install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.org/tinytex/. "],["intro.html", "Chapter 2 Overview", " Chapter 2 Overview You can label chapter and section titles using {#label} after them, e.g., we can reference Chapter 2. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter ??. Figures and tables with captions will be placed in figure and table environments, respectively. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa You can write citations, too. For example, we are using the bookdown package (Xie 2020) in this sample book, which was built on top of R Markdown and knitr (Xie 2015). All large datasets and computationallly intensive processing steps for fMRI analysis takes place via computers at the Minnesota Supercomputing Institute (MSI) or the Center for Magnetic Resonance Research (CMRR). This guide will layout the steps you need to take in order to access MSI. Subsequent manuals will address how to navigate the MSI and find stored data, and ultimately run image processing and analyses through MSI. References "],["VPN.html", "Chapter 3 Acccessing UMN’s VPN and MSI or CMRR", " Chapter 3 Acccessing UMN’s VPN and MSI or CMRR For MSI you can access with just Split Tunnel, and for CMRR you will need to use Departmental Pools \\(&gt;\\) Anyconnect-CMRR To gain the rights to access the CMRR or MSI’s VPN, you will need to fill out the request by clicking ‘Register’ and completing the form. the investigator on your project (i.e. Dr. Kate Cullen) will be notified and they can grant you access. knitr::include_graphics(&#39;./Images/CMRR_log_reg.png&#39;) {#fig:CMRR_login_regis} open anyConnect. In the ‘connect to’ box enter ‘tc-vpn-1.vpn.umn.edu’. The group you will connect to differs for MSI and CMRR. For MSI choose ‘AnyConnect-UofMSplit’. For CMRR choose ‘Department-Pools’ then ‘Anyconnect-CMRR’ then type your credentials. Tadah! you are now on the VPN. To confirm you are go to the following address www3.cmrr.umn.edu. If it loads, you were successful. "],["installvpn.html", "Chapter 4 Install VPN 4.1 System non-specific: Downloading AnyConnect for installation 4.2 Windows 4.3 Mac 4.4 Linux", " Chapter 4 Install VPN 4.1 System non-specific: Downloading AnyConnect for installation In order to access either MSI or CMRR from off-campus you must log in to MSI’s network with a VPN (a VPN is a Virtual Private Network. It is how you can access the MSI remotely.) The university recommends using Cisco AnyConnect. Here are the steps to set up a Cisco VPN. The hyperlink will also be in the footnotes (https://it.umn.edu/services-technologies/virtual-private-network-vpn). Follow the URL hyperlink in the previous sentence. You will be brought to a page that all the downloads for different operating systems as shown below. Locate the download for your operating system and click “Download”. The download file should take a few seconds to fully download. The next steps will depend on the OS you are using. knitr::include_graphics(&#39;./Images/Anyconnect_Downloads.png&#39;) 4.2 Windows 4.2.1 Installing AnyConnect Right click the zipped file that was downloaded to your Downloads folder and ‘Extract all’. Open the new file folder of the same name of the one just unzipped. Right click the file called ‘Install-batch’ and select ‘Run as administrator’. (Note: you will need to have administrative rights to run this command) A pop up will display the installation progress and then eventually when the process is complete. 4.2.2 Connecting to UMN VPN Navigate to Cisco AnyConnect Secure Mobility Client from the Start menu. Start menu button in Windows 10 &gt; All apps &gt; Cisco &gt; Cisco AnyConnect Secure Mobility Client knitr::include_graphics(&#39;./Images/Win_anyconnect.png&#39;) Select your connection preference from the drop-down menu. UMN - Split Tunnel - for MSI. Departmental Pools - For CMRR -&gt; Select your specific departmental pool after clicking ‘Connect’. Click connect, enter credentials then ok. you are connected. 4.3 Mac 4.3.1 Installing AnyConnect Find and open the anyconnect-mac-[version]-repack-signed.pkg installer package in your Downloads folder. Follow the steps in the UMN Cisco AnyConnect Installer until the installation is complete. See the General tab in System Preferences to Allow the Cisco Extension. 4.3.2 Connecting to Umn VPN Navigate to Cisco AnyConnect Secure Mobility Client from file ‘Finder’ Select your connection preference from the drop-down menu. See Fig. UMN - Split Tunnel - for MSI. Departmental Pools - For CMRR -&gt; Select your specific departmental pool after clicking ‘Connect’. Click connect, enter credentials then ok. you are connected. 4.4 Linux 4.4.1 Installing AnyConnect Before moving forward with the installation open terminal and run the following commands. to make sure linux is up to date for the installation and has all of the necessary dependencies. caption=Bash commands to update and install dependencies for the VPN. “$ sudo apt-get update” “$ sudo apt-get install lib32z1 lib32ncurses6” The package will be downloaded as a .tar.gz file extension (called a tarball). You can unzip the tarball in one of two ways. 1) You can naviagte to Dowloads in your file manager, right click and choose extract here. 2) Using command line you can use the following commands. caption=the first line changes directories (cd) to your downloads folder. The dollar sign ($) is not something you have to type in it just appears at the beginning of the command prompt after listing your current directory. The tilda (~) is a reference to your home directory. The second line contains the necessary information for unzipping the tar file. xvfz are ‘flags’ that tell tar exactly what you want to do. x- means you want to e(x)tract the folder. v- verbose, so it will show you every output from the unzipping process. f- means you’re going to specify the tar file name to be unzipped. z- specifies that it is a gzip style compression (we know this given the .gz extension). The asterisk () is a wild card that can account for any sequence of characters. It is a good idea to manually enter the file name that appears in your Downloads folder to avoid any mishaps just in case you have multiple tarball files. “$ cd ~/Downloads” \"$ tar xvfz anyconnect.tar.gz\" Unzipping the tarball will leave a directory with the same name as the tarball file. Navigate into this directory either in the file manager or via command line using the ‘cd’ command followed by the name of the directory. Then, navigate to the vpn folder. If you’re using the file manager, write click the file called ‘vpn_install.sh’ and run it. This is a shell script (.sh) that will install the vpn for you. Or else, in the command line run the line below. You will be prompted to fill out your password to grant root access via sudo. Accept the licensing agreement and it will install. At the end of the installation it should tell you that it is done. caption=The command to run the installastion script from terminal. sudo grants the computer root access allowing it to properly install. “$ sudo vpn_./install.sh” Next, in the unzipped folder navigate to the directory called ‘dart’. install dart via command line using “sudo ./dart_install.sh.” "],["MSI.html", "Chapter 5 Setting up and accessing MSI", " Chapter 5 Setting up and accessing MSI MSI questions are answered Go to this and login using your MSI credentials (Are these x500 or same as CMRR????) On the left side-bar click “Download DCV client.” Select the appropriate version for your computer and install it. Please uninstall any previous version of NICE first. Note that installing the client on Linux will uninstall any other version of VirtualGL/TurboVNC you have installed. If you are installing on Mac, you need to control-click on “DCV Endstation” in Applications and open it, and then accept the unsigned software warning. This only needs to be done once. In the top right corner of the page, there is a link labeled “Settings.” There you will be able to set the default display resolution of the NICE session to suit your needs, so if the NICE session takes up too much space on your screen, or isn’t large enough for you to see very well, it can be changed here. After you have installed the client, back on the NICE website, click one of the options associated with the amount of time, memory, and GPU usage you require. You may be confronted with an error with the VNC signature. If this is the case, just click yes and proceed. Your web browser should then launch a VNC viewer with a desktop. From there, you can open a terminal, load modules, and run any lab-installed software. To check that DCV acceleration is working, open a terminal and run “dcvtest”. "],["cmrr.html", "Chapter 6 CMRR 6.1 First time CMRR users 6.2 Accessing CMRR", " Chapter 6 CMRR 6.1 First time CMRR users You will need to set up your CMRR Password and figure out your login id. To do this follow This time, instead of clicking ‘Register’ click ‘Login’ and login with your x500 (normal UMN credentials). Then in the tabs on the CMRR page click ‘My Profile’ then ‘Change CMRR Server Password’. First, write down your login ID Then, enter a new password (this will be used only when accessing CMRR machines through NoMachine. More on that later). it will take a few minutes for your password to update and a day or two for your initial access to be granted to the CMRR computers. 6.2 Accessing CMRR For CMRR questions go . 1. Follow This will always be how you access CMRR computers, so bookmark it. 2. Enter the credentials that you just set up for CMRR 3. Select ‘Create a new virtual desktop’ (The left most option) 4. Then you are in the CMRR login computer! knitr::include_graphics(&#39;./Images/NX_create_VM.png&#39;) To access a computer that has processing power use the following command caption=Code to create a secure shell connection (ssh) to another computer on CMRR. “$ssh @lnpi15.cmrr.umn.edu” For example, “$ ssh ccoffma@lnpi15.cmrr.umn.edu” 6. First time users will need to allow the key. 7. Enter your CMRR credentials. "],["references.html", "References", " References "],["data-locations.html", "Chapter 7 Data locations 7.1 CMRR 7.2 MSI", " Chapter 7 Data locations 7.1 CMRR 7.1.1 BRIDGES cd ’ /../../lnpi14-raid4/bids/275_BRIDGES/HCP4_output’ 7.1.2 Programs In Bash type ‘matlab\\(&lt;\\)year\\(&gt;\\)’ to see years hit the tab key after matlab and it will show you the list. 7.1.3 Scripts for loading toolkits in Matlab run \\(&gt;&gt;\\) run(‘~timothy/matlab/startup.m’) then run \\(&gt;&gt;groupica\\) groupica 7.2 MSI 7.2.1 BRIDGES 7.2.2 ABCD 7.2.3 Programs 7.2.4 Scripts for loading toolkits "],["GIFT.html", "Chapter 8 GIFT 8.1 Overview of GIFT and it’s tools 8.2 Opening GIFT 8.3 Running Infomax ICA 8.4 Running GIG-ICA analysis 8.5 ICA output files 8.6 ", " Chapter 8 GIFT 8.1 Overview of GIFT and it’s tools ICA’s-many algorithms GIG-ICA- Infomax- 8.2 Opening GIFT GIFT is a toolbox built in matlab. In order to enter matlab from command line enter ‘matlab’. To specify the edition type ‘matlab2017b’ or equivalent. Once in matlab it’s convenient to load all of the toolboxes you might use for fMRI analyses at once. This is held in a matlab script and can be called using run('~timothy/matlab/startup.m') open GIFT by entering groupica. This will open a GUI interface. 8.3 Running Infomax ICA Infomax is the most basic ICA algorthim and takes the fewest inputs. Simply specify the files and number of independent components you want to run. gica_cmd –data ‘C:001.nii’ ‘C:002.nii –n 15 8.4 Running GIG-ICA analysis GIG-ICA uses the spatial maps generated from Infomax run, so before running GIG-ICA, go through and run the entire Infomax method. gica_cmd –data ‘C:001.nii’ ‘C:002.nii’ ‘C:003.nii’ –templates ‘C:_ref.nii’ –a gig-ica 8.5 ICA output files 8.6 "],["fsl-basics.html", "Chapter 9 FSL basics 9.1 Visualizing files 9.2 Registering files to standard spaces 9.3 Creating atlas masks", " Chapter 9 FSL basics 9.1 Visualizing files 9.2 Registering files to standard spaces epi_reg 9.3 Creating atlas masks "],["shell.html", "Chapter 10 List of useful shell commands 10.1 Navigating (beginner) 10.2 File manipulatio", " Chapter 10 List of useful shell commands 10.1 Navigating (beginner) ssh- creates a secure shell connection to another computer on the network. You will be prompted for a passwod after entering. “$ ssh (???)(???)” cd- changes directories “$ cd ” “$ cd /home” Useful tips a. cd without an argument sends you home b. .. is the argument to bring you back up one directory c. ~ means home and is useful when you are writing scripts to make sure you’re consistently referenceing the same directory. “$ cd ~/data/analysis/” 3. ls- lists all visible files in a directory “$ ls /home” Useful tips: a. Flags: -a lists everything plus normally invisible files, -l lists the last modified dates b. ls without any arguments lists visible contents in current directory. 4. less- is used to strictly read files without editing options. “$ less \\(&lt;\\)file name\\(&gt;\\)” 10.2 File manipulatio chmod- adds file permissions Useful flags: -x enables execution rights -w enables writing rights -r enables reading rights cp- copies a file to another place find- searches a set of directories for a file name mkdir- creates an empty directory mv- moves a file or directory rm- removes a file rmdir- removes an empty directory vi- opens a file with writing privileges ./\\(&lt;\\)file name\\(&gt;\\)- runs a custom bash script with the name ‘\\(&lt;\\)file name\\(&gt;\\)’. Xie, Yihui. 2015. Dynamic Documents with R and Knitr. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. http://yihui.org/knitr/. ———. 2020. Bookdown: Authoring Books and Technical Documents with R Markdown. https://github.com/rstudio/bookdown. "]]
